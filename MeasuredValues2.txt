import java.io.*;

public class MeasuredValues {
	
	static int al=readInt("Bitte die Größe des Arrays bestimmen");
	static int[] arr=new int [al];
	static String fileName=new String();
	
	public static int readInt(String text) {
		BufferedReader in=new BufferedReader(
				new InputStreamReader(System.in));
		System.out.print(text+": ");
		try {									// Überwachungsblock
			return Integer.parseInt(in.readLine());
		}
		catch (IOException e) {					//Fehlerbehandlungsblock
			System.out.println("IO error");
			return 1;
		}
		catch (NumberFormatException e) {		//Fehlerbehandlungsblock
			System.out.println("NumberFormat error");
			return 1;
		}
	}
	
	static void shellSort(int[] arr) {
		int temp=0, h=1, j=0;
		do
			h=3*h+1;
		while (h<arr.length);
		do {
			h=h/3;
			for (int i=h;i<arr.length;i++) {
				temp=arr[i];
				j=i;
				while ((j>=h)&&(arr[j-h]>temp)) {
					arr[j]=arr[j-h];
					j=j-h;
				}
				arr[j]=temp;
			}
		} while (h!=1);
	}
	
	static int findMax(int arr[]) {
		int max=0;
		for (int i=0;i<arr.length;i++) {
			if (arr[i] > arr[max])
				max=i;
		}
		return max;
	}
	
	static int findMin(int arr[]) {
		int max=0;
		for (int i=0;i<arr.length;i++) {
			if (arr[i] < arr[max])
				max=i;
		}
		return max;
	}
	
	static float sumAverage(int arr[]) {
		float Summe=0, Mittelwert=0;
		for (int i=0; i<arr.length;i++)
			Summe+=arr[i];
		System.out.println("Die Summe des Arrays ist: "+Summe);
		System.out.println("Der Länge des Arrays ist: "+arr.length);
		Mittelwert=(Summe/arr.length);		
		return Mittelwert;
	}
	
	public static String readString() {
		   try {
		     BufferedReader in = new BufferedReader(
		              new InputStreamReader(System.in) );
		     String s = in.readLine();
		     return s;     // Gelesenen String zurückgeben
		   } catch( IOException ex ) {
		     System.out.println( ex.getMessage() );
		   }
		   return "- Nichts gelesen -";
		 }
	
	private static void writeBytes(int[] data) {
		try {
			FileOutputStream file=new FileOutputStream(fileName);
				for (int i=0;i<data.length;i++)
					file.write(data[i]);
			file.close();
			System.out.println("\nDatei \""+fileName+"\" erfolgreich gespeichert!");
		} catch (IOException e) {
			System.out.println("Error -- "+e.toString());
		}
	}
	
	private static int[] readBytes(int[] test) {
		try {
			FileInputStream file=new FileInputStream(fileName);
			BufferedInputStream buff=new BufferedInputStream(file);
			DataInputStream data=new DataInputStream(buff);
			int[] arr = new int[al];
			int zaehler=0;
			try {
				while (true) {
					arr[zaehler++]=data.readInt();
				} 
			} catch (EOFException eof) {
				buff.close();
			}
		} catch (IOException e) {
				System.out.println("Error -- "+e.toString());
			}
		System.out.println("\nDatei \""+fileName+"\" erfolgreich eingelesen!");
		return arr;
	}
	
	private static void ausgabe(int[] arr2) {
		System.out.print("\nDie Werte des Arrays sind: [ ");
		for (int i=0; i<arr.length;i++)
			System.out.print(arr[i]+" ");
		System.out.println("]");
	}

	public static void main(String[] args) {
		for (int i=0;i<arr.length;i++) {
			int number=readInt("Bitte die "+(i+1)+". von "+al+" Zahlen eingeben");
			arr[i]=number;
		}
		ausgabe(arr);	
		shellSort(arr);
		System.out.println("\nSortiere...");
		ausgabe(arr);
		int erg=findMax(arr);
		System.out.println("Das Maximum des Arrays ist: "+arr[erg]);
		int erg2=findMin(arr);
		System.out.println("Das Minimum des Arrays ist: "+arr[erg2]);
		float Mittelwert=sumAverage(arr);		
		System.out.println("Der Mittelwert des Arrays ist: "+Mittelwert);
		System.out.println("Bitte den Dateinamen eingeben: ");
		fileName=readString();
		try {
			FileOutputStream file=new FileOutputStream(fileName);
			file.close();
		} catch (IOException e) {
			System.out.println("Error -- "+e.toString());
		}
		writeBytes(arr);
		System.out.println("\nErneutes Einlesen von \""+fileName+"\"...");
		readBytes(arr);
		ausgabe(arr);	
	}
}
